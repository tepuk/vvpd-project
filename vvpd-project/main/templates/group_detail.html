{% extends 'base.html' %}

{% block title %}Информация о группе {{ group.name }}{% endblock %}

{% block content-header %}
<h3 class="text-center">Информация о группе {{ group.name }}</h3>
{% endblock %}

{% block content %}
<input type="text" class="form-control" id="search" placeholder="Поиск по ФИО...">
<div class="table-wrapper-scroll-y scrollbar">
    <table id="group-detail-table" class="table-scrolls">
        <thead>
            <tr>
                <th class="text-center" width="3%" data-sort-method='none'>#</th>
                <th class="text-center name data-sort" width="23%">ФИО</th>
                <th class="text-center" width="10%" data-sort-method='none'>Группа</td>
                <th class="text-center" width="10%" data-sort-method='none'>Форма обучения</th>
                <th class="text-center" width="10%" data-sort-method='none'>Ссылка VK</th>
                <th class="text-center" width="10%" data-sort-method='none'>Ссылка Git</th>
                <th class="text-center" width="8%" data-sort-method='none'>Действия</th>
            </tr>
        </thead>
        <tbody>
            {% for student in students %}
            <tr>
                <td class="text-center">{{ forloop.counter }}</td>
                <td class="text-center name"><a href="{% url 'student_detail_group' student.user.id student.group.id %}">{{ student.user.get_full_name}}</a></td>
                <td class="text-center">{{ student.group }}</td>
                <td class="text-center">{{ student.form_of_education }}</td>
                <td class="text-center">
                    <a href="{{ student.link_vk }}" target="_blank">{{ student.link_vk }}</a>
                </td>
                <td class="text-center">
                    <a href="{{ student.link_gitlab }}" target="_blank">{{ student.link_gitlab }}</a>
                </td>
                <td class="text-center">
                    <a class="update-achievement btn btn-sm btn-primary" href="#">
                        <span class="fa fa-edit"></span>
                    </a>
                    <a class="delete-achievement btn btn-sm btn-danger" href="#">
                        <span class="fa fa-trash"></span>
                    </a>
                </td>
            </tr>
            {% endfor %}
        </tbody>
    </table>
    <div class="error-search text-center mt-3" style="display: none;">
        <p><i class="fa fa-exclamation-circle"></i>По вашему запросу ничего не найдено</p>
    </div>
</div>
<br>
<div class="d-flex justify-content-center mb-4">
    <a class="btn btn-primary" href="{% url 'group' %}">Назад</a>
</div>
{% endblock %}

{% block script %}
<script>
    $("#search").on("keyup", function () {
        var inputValue = $(this).val().toLowerCase();
        var count = 0
        $("#group-detail-table tbody tr").filter(function () {
            if ($(this).children('.name').text().toLowerCase().indexOf(inputValue) > -1) count++;
            $(this).toggle($(this).children('.name').text().toLowerCase().indexOf(inputValue) > -1)
        });
        if (count == 0) {
            $('.error-search').show();
        } else {
            $('.error-search').hide();
        }
    });

    new Tablesort(document.getElementById('group-detail-table'));
</script>
{% endblock %}
